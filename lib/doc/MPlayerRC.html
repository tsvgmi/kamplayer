<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: MPlayerRC</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (M)</a> &raquo; 
    
    
    <span class="title">MPlayerRC</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: MPlayerRC
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">MPlayerRC</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">mpshell.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Remote controller for Mplayer via its RC interface. Use the input pipe to
write command, and monitor output file for any status change. Start method
should be used here to setup the matching interface.
</p>


  </div>
</div>
<div class="tags">
  
</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="MINPUT-constant" class="">MINPUT =
          
        </dt>
        <dd><pre class="code"><span class='string val'>&quot;mp.input&quot;</span>
</pre></dd>
      
        <dt id="MOUTPUT-constant" class="">MOUTPUT =
          
        </dt>
        <dd><pre class="code"><span class='string val'>&quot;mp.output&quot;</span>
</pre></dd>
      
    </dl>
  


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#rchan-instance_method" title="#rchan (instance method)">- (Object) <strong>rchan</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute rchan.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#wchan-instance_method" title="#wchan (instance method)">- (Object) <strong>wchan</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute wchan.
</p>
</div></span>
  
</li>

    
  </ul>


  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup-class_method" title="setup (class method)">+ (Object) <strong>setup</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-class_method" title="start (class method)">+ (Object) <strong>start</strong>(options) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Cannot start by object b/c object represent channel which cannot be opened
till the process have been started.
</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_response-instance_method" title="#get_response (instance method)">- (Object) <strong>get_response</strong>(timeout) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (MPlayerRC) <strong>initialize</strong>(options = {}) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
A new instance of MPlayerRC.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#monitor_for-instance_method" title="#monitor_for (instance method)">- (Object) <strong>monitor_for</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#monitor_start-instance_method" title="#monitor_start (instance method)">- (Object) <strong>monitor_start</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send-instance_method" title="#send (instance method)">- (Object) <strong>send</strong>(acmd, wait = 0) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="MPlayerRC (class)">MPlayerRC</a></span></tt>) <strong>initialize</strong>(options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
A new instance of MPlayerRC
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 96</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@options ivar id'>@options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span>
  <span class='@trace ivar id'>@trace</span>   <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:trace</span><span class='rbrack token'>]</span>
  <span class='@wchan ivar id'>@wchan</span>   <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='unless unless kw'>unless</span> <span class='test identifier id'>test</span><span class='lparen token'>(</span><span class='integer val'>?f</span><span class='comma token'>,</span> <span class='MOUTPUT constant id'>MOUTPUT</span><span class='rparen token'>)</span>
    <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='MOUTPUT constant id'>MOUTPUT</span><span class='comma token'>,</span> <span class='string val'>&quot;w&quot;</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='@rchan ivar id'>@rchan</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='MOUTPUT constant id'>MOUTPUT</span><span class='rparen token'>)</span>
  <span class='@rchan ivar id'>@rchan</span><span class='dot token'>.</span><span class='seek identifier id'>seek</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="rchan-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="rchan-instance_method">
  
    - (<tt>Object</tt>) <strong>rchan</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute rchan
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 94</span>

<span class='def def kw'>def</span> <span class='rchan identifier id'>rchan</span>
  <span class='@rchan ivar id'>@rchan</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="wchan-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="wchan-instance_method">
  
    - (<tt>Object</tt>) <strong>wchan</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute wchan
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 94</span>

<span class='def def kw'>def</span> <span class='wchan identifier id'>wchan</span>
  <span class='@wchan ivar id'>@wchan</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="setup-class_method">
  
    + (<tt>Object</tt>) <strong>setup</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 175</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='setup identifier id'>setup</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='MOUTPUT constant id'>MOUTPUT</span><span class='comma token'>,</span> <span class='string val'>&quot;w&quot;</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="start-class_method">
  
    + (<tt>Object</tt>) <strong>start</strong>(options) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Cannot start by object b/c object represent channel which cannot be opened
till the process have been started.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 156</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:sim</span><span class='rbrack token'>]</span>
  <span class='cache identifier id'>cache</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:cache</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='integer val'>8000</span>
  <span class='MPlayer constant id'>MPlayer</span><span class='dot token'>.</span><span class='kill_process identifier id'>kill_process</span><span class='lparen token'>(</span><span class='regexp val'>/mplayer.*-slave/</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='test identifier id'>test</span><span class='lparen token'>(</span><span class='integer val'>?p</span><span class='comma token'>,</span> <span class='MINPUT constant id'>MINPUT</span><span class='rparen token'>)</span>
    <span class='Pf constant id'>Pf</span><span class='dot token'>.</span><span class='system identifier id'>system</span><span class='lparen token'>(</span><span class='dstring node'>&quot;mkfifo #{MINPUT}&quot;</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='popt identifier id'>popt</span> <span class='assign token'>=</span> <span class='string val'>&quot;-autosync 30 -slave -quiet -framedrop -rootwin -vf yadif -nograbpointer -vf scale -idle -double&quot;</span>
  <span class='if if kw'>if</span> <span class='osd identifier id'>osd</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:osd</span><span class='rbrack token'>]</span>
    <span class='popt identifier id'>popt</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot; -osdlevel #{osd}&quot;</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:fs</span><span class='rbrack token'>]</span>
    <span class='popt identifier id'>popt</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot; -fs&quot;</span>
  <span class='else else kw'>else</span>
    <span class='popt identifier id'>popt</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot; -geometry 0:0&quot;</span>
  <span class='end end kw'>end</span>
  <span class='Pf constant id'>Pf</span><span class='dot token'>.</span><span class='system identifier id'>system</span><span class='lparen token'>(</span><span class='dstring node'>&quot;mplayer -idx -cache #{cache} #{popt} -xineramascreen 1 -input file=#{MINPUT} &gt;&gt;#{MOUTPUT} 2&gt;&amp;1 &amp;&quot;</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="get_response-instance_method">
  
    - (<tt>Object</tt>) <strong>get_response</strong>(timeout) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124
125
126
127
128
129
130
131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 122</span>

<span class='def def kw'>def</span> <span class='get_response identifier id'>get_response</span><span class='lparen token'>(</span><span class='timeout identifier id'>timeout</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:sim</span><span class='rbrack token'>]</span>
  <span class='while while kw'>while</span> <span class='timeout identifier id'>timeout</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='while while kw'>while</span> <span class='line identifier id'>line</span> <span class='assign token'>=</span> <span class='@rchan ivar id'>@rchan</span><span class='dot token'>.</span><span class='gets identifier id'>gets</span>
      <span class='if if kw'>if</span> <span class='@trace ivar id'>@trace</span>
        <span class='print identifier id'>print</span> <span class='line identifier id'>line</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='sleep identifier id'>sleep</span> <span class='integer val'>1</span>
    <span class='timeout identifier id'>timeout</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="monitor_for-instance_method">
  
    - (<tt>Object</tt>) <strong>monitor_for</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141
142
143
144
145
146
147
148
149
150
151
152</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 139</span>

<span class='def def kw'>def</span> <span class='monitor_for identifier id'>monitor_for</span>
  <span class='comment val'># Loop and wait till event is detected.</span>
  <span class='lcnt identifier id'>lcnt</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='while while kw'>while</span> <span class='true true kw'>true</span>
    <span class='while while kw'>while</span> <span class='line identifier id'>line</span> <span class='assign token'>=</span> <span class='@rchan ivar id'>@rchan</span><span class='dot token'>.</span><span class='gets identifier id'>gets</span>
      <span class='if if kw'>if</span> <span class='yield yield kw'>yield</span><span class='lparen token'>(</span><span class='line identifier id'>line</span><span class='comma token'>,</span> <span class='lcnt identifier id'>lcnt</span><span class='rparen token'>)</span>
        <span class='return return kw'>return</span> <span class='true true kw'>true</span>
      <span class='end end kw'>end</span>
      <span class='lcnt identifier id'>lcnt</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
    <span class='end end kw'>end</span>
    <span class='sleep identifier id'>sleep</span> <span class='integer val'>1</span>
  <span class='end end kw'>end</span>
  <span class='false false kw'>false</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="monitor_start-instance_method">
  
    - (<tt>Object</tt>) <strong>monitor_start</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 135</span>

<span class='def def kw'>def</span> <span class='monitor_start identifier id'>monitor_start</span>
  <span class='@rchan ivar id'>@rchan</span><span class='dot token'>.</span><span class='seek identifier id'>seek</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="send-instance_method">
  
    - (<tt>Object</tt>) <strong>send</strong>(acmd, wait = 0) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114
115
116
117
118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'mpshell.rb', line 107</span>

<span class='def def kw'>def</span> <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='acmd identifier id'>acmd</span><span class='comma token'>,</span> <span class='wait identifier id'>wait</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='@trace ivar id'>@trace</span>
    <span class='Plog constant id'>Plog</span><span class='dot token'>.</span><span class='info identifier id'>info</span> <span class='dstring node'>&quot;Sending #{acmd}&quot;</span>
  <span class='end end kw'>end</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:sim</span><span class='rbrack token'>]</span>
  <span class='unless unless kw'>unless</span> <span class='@wchan ivar id'>@wchan</span>
    <span class='@wchan ivar id'>@wchan</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='MINPUT constant id'>MINPUT</span><span class='comma token'>,</span> <span class='string val'>&quot;w&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='@wchan ivar id'>@wchan</span><span class='dot token'>.</span><span class='puts identifier id'>puts</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{acmd}&quot;</span><span class='rparen token'>)</span>
  <span class='@wchan ivar id'>@wchan</span><span class='dot token'>.</span><span class='flush identifier id'>flush</span>
  <span class='if if kw'>if</span> <span class='wait identifier id'>wait</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='get_response identifier id'>get_response</span><span class='lparen token'>(</span><span class='wait identifier id'>wait</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sat Nov 13 19:11:23 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.8.7).
</div>

  </body>
</html>